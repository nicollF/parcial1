
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Punto 2 (parte 1) y Punto 3 &#8212; Primer parcial Machine Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'segundopunto_parte1';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Punto 2 (parte 2)" href="segundopunto_parte2.html" />
    <link rel="prev" title="Punto 1 (parte 2)" href="primerpunto_parte2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/uninortelogo.jpeg" class="logo__image only-light" alt="Primer parcial Machine Learning - Home"/>
    <script>document.write(`<img src="_static/uninortelogo.jpeg" class="logo__image only-dark" alt="Primer parcial Machine Learning - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Primer parcial ML.
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="primerpunto_parte1.html"><strong>Primer Punto (Parte 1)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="primerpunto_parte2.html"><strong>Punto 1 (parte 2)</strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Punto 2 (parte 1) y Punto 3</strong></a></li>


<li class="toctree-l1"><a class="reference internal" href="segundopunto_parte2.html"><strong>Punto 2 (parte 2)</strong></a></li>


<li class="toctree-l1"><a class="reference internal" href="cuartopunto.html"><strong>Ejercicio 4 (modelo de regresión)</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fsegundopunto_parte1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/segundopunto_parte1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Punto 2 (parte 1) y Punto 3</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Punto 2 (parte 1) y Punto 3</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#neurips-2024-predict-new-medicines-with-belka"><strong>NeurIPS 2024 - Predict New Medicines with BELKA</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contexto"><strong>Contexto</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eda-punto-2"><strong>EDA: Punto 2</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conjunto-de-entrenamiento"><strong>Conjunto de entrenamiento</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#preliminares"><strong>Preliminares</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#filtro-por-proteina"><strong>Filtro por proteina</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#seh-hidrolasa-de-epoxido-soluble"><em><strong>SEH: Hidrolasa de Epóxido Soluble.</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-inicial"><strong>Análisis inicial.</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#codificacion-de-las-variables-categoricas"><strong>Codificación de las variables categoricas.</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#reduccion-de-multicolinialidad"><strong>Reducción de multicolinialidad.</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hsa-soluble-epoxide-hydrolase-2"><em><strong>HSA: Soluble Epoxide Hydrolase 2.</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>Análisis inicial.</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>Codificacíon de las variables categóricas.</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>Reducción de multicolinialidad.</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#brd4-bromodomain-containing-protein-4"><em><strong>BRD4: Bromodomain-containing protein 4</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>Análisis inicial.</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><strong>Codificación de las variables categóricas.</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><strong>Reducción de multicolinialidad</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelacion-punto-3"><strong>Modelación: Punto 3</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seh"><em><strong>SEH</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nn"><strong>K-NN</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logistica"><strong>Regresión logistica</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas"><strong>Métricas</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#curvas-roc-y-matrices-de-confucion"><strong>Curvas ROC y matrices de confución</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hsa"><em><strong>HSA</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><strong>K-NN</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><strong>Regresión logística.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><strong>Métricas.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#curvas-roc-y-matrices-de-confusion"><strong>Curvas ROC y matrices de confusión.</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brd4"><strong>BRD4</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><strong>K-NN</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><strong>Regresión logística.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><strong>Métricas</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13"><strong>Curvas ROC y matrices de confusión</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">mglearn</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">neighbors</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_log_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">explained_variance_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">ConfusionMatrixDisplay</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="punto-2-parte-1-y-punto-3">
<h1><strong>Punto 2 (parte 1) y Punto 3</strong><a class="headerlink" href="#punto-2-parte-1-y-punto-3" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="neurips-2024-predict-new-medicines-with-belka">
<h1><strong>NeurIPS 2024 - Predict New Medicines with BELKA</strong><a class="headerlink" href="#neurips-2024-predict-new-medicines-with-belka" title="Link to this heading">#</a></h1>
<section id="contexto">
<h2><strong>Contexto</strong><a class="headerlink" href="#contexto" title="Link to this heading">#</a></h2>
<p>Los farmacos de moleculas pequeñas son sustacioas químicas,  estas sustancias tienen como objetivos inhibir la actividad de dianas proteicas individuales. La idea es identificar cuales farmacos, logran inhibir la actividad de las proteinas. Normalmente el enfoque es fabricar las moleculas fisicamente una por una y probarla con cada proteina de interés y combrobar si estas interactuan. Visto de esta forma este proceso es un proceso que requiere de mucho tiempo, es por esta razón que se quiere hallar una forma de predecir la unión de las moleculas y proteinas mediante modelos de clasificación.
Los datos se recompilaron mediante la tecnología de biblioteca quimica codificada por ADN(DEL).</p>
<p><em>Tomado de: <a class="reference external" href="https://www.kaggle.com/competitions/leash-BELKA/data">NeurIPS 2024 - Predice nuevos medicamentos con BELKA</a></em></p>
<p><strong>Notación SMILE</strong></p>
<p>La notación SMILE es utilizada para representar la estructura de las moleculas quimicas, codificando el grafo molecular,incluyendo atomos, enlaces y contevtividad en una secuencua de caracteres.</p>
<p><strong>Datos:</strong></p>
<ul class="simple">
<li><p><strong>id</strong>: Identificación única para el ejemplo de la unión molécula-proteina.</p></li>
<li><p><strong>buildingblock1_smiles</strong>: Estructura del primer bloque de construcción en SMILE.</p></li>
<li><p><strong>buildingblock2_smiles</strong>: Estructura del segundo bloque de construcción en SMILE.</p></li>
<li><p><strong>buildingblock3_smiles</strong> - Estructura del tercer bloque de construcción en SMILE.</p></li>
<li><p><strong>molecule_smiles</strong> - La estructura de la molécula completamente ensamblada, en SMILES. Esto incluye los tres bloques de construcción y el núcleo de triazina.</p></li>
<li><p><strong>protein_name</strong>: El nombre de la proteína objetivo</p></li>
<li><p><strong>binds</strong> : Una etiqueta de clase binaria que indica si la molécula se une a la proteína.</p></li>
</ul>
<p><strong>Análisis de las proteinas objetivo:</strong></p>
<ol class="arabic simple">
<li><p><strong>EPHX2 (sEH)</strong>
La epóxido hidrolasa 2, codificada por el gen EPHX2 y conocida como sEH, desempeña un papel en la hipertensión y la diabetes. Los inhibidores de sEH han progresado hasta estudios clínicos. Durante el pasado, EPHX2/sEH se evaluó usando DEL y se optaron por resultados con aprendizaje automático, aunque los datos no se han dado a conocer. EPHX2/sEH se incluyó en las evaluaciones con el propósito de posibilitar a los participantes comparar el rendimiento de sus modelos con resultados anteriores.</p></li>
<li><p><strong>BRD4</strong>
La proteína BRD4, codificada por el gen BRD4, está unida a Histonas en el núcleo y regula la transcripción del ADN, lo cual tiene un impacto en la expresión genética. Los dominios bromodominios, tales como BRD4, están relacionados con la progresión del cáncer, y se han puesto en marcha terapias que inhibien sus funciones. BRD4 ha sido previamente estudiado con enfoques DEL, pero los resultados no fueron publicados; se incluyó en evaluaciones para probar moléculas candidatas en oncología.</p></li>
<li><p><strong>ALB (HSA)</strong>
La albúmina sérica, codificada por el gen ALB y conocida como HSA, es la proteína más abundante en el sistema cardiovascular. Su función fundamental radica en mantener la presión osmótica y transportar diversas moléculas, tales como hormonas y ácidos grasos. Dado su elevada concentración, la albúmina tiene un impacto en la absorción y distribución de medicamentos en el cuerpo, por lo que disminuir la unión de los medicamentos con esta proteína puede incrementar su efectividad.</p></li>
</ol>
<p>En los datos suministrados en la plataforma de Kaggle, se pueden obtener un conjunto de datos de entrenamiento, que es el que será usado para este estudio y un conjunto de test, este conjunto de test no será usado para este estudio, puesto que no cuenta con la presencia de la variable respuesta, es decir, no cuenta con la variable binaria que indica si se unió o no la proteína con la molécula, por tanto no se podrá medir de forma adecuada si los modelos lanzados funcionan bien en el conjunto de test, por estas razones se dividirá el conjunto de entrenamiento original para poder tener un conjunto de test adecuado.</p>
</section>
<section id="eda-punto-2">
<h2><strong>EDA: Punto 2</strong><a class="headerlink" href="#eda-punto-2" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectKBest</span><span class="p">,</span> <span class="n">chi2</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</pre></div>
</div>
</div>
</div>
<section id="conjunto-de-entrenamiento">
<h3><strong>Conjunto de entrenamiento</strong><a class="headerlink" href="#conjunto-de-entrenamiento" title="Link to this heading">#</a></h3>
<section id="preliminares">
<h4><strong>Preliminares</strong><a class="headerlink" href="#preliminares" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:/Users/fonta/OneDrive/Escritorio/train.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>buildingblock1_smiles</th>
      <th>buildingblock2_smiles</th>
      <th>buildingblock3_smiles</th>
      <th>molecule_smiles</th>
      <th>protein_name</th>
      <th>binds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.Br.NCC1CCCN1c1cccnn1</td>
      <td>C#CCOc1ccc(CNc2nc(NCC3CCCN3c3cccnn3)nc(N[C@@H]...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.Br.NCC1CCCN1c1cccnn1</td>
      <td>C#CCOc1ccc(CNc2nc(NCC3CCCN3c3cccnn3)nc(N[C@@H]...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.Br.NCC1CCCN1c1cccnn1</td>
      <td>C#CCOc1ccc(CNc2nc(NCC3CCCN3c3cccnn3)nc(N[C@@H]...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(295246830, 7)
</pre></div>
</div>
</div>
</div>
<p>Vemos que el dataset cuenta con casi 300 millones de registro y un total de 7 columnas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 295246830 entries, 0 to 295246829
Data columns (total 7 columns):
 #   Column        Dtype 
---  ------        ----- 
 0   id            int64 
 1   block1        object
 2   block2        object
 3   block3        object
 4   molecule      object
 5   protein_name  object
 6   binds         int64 
dtypes: int64(2), object(5)
memory usage: 15.4+ GB
</pre></div>
</div>
</div>
</div>
<p>Cada una de las variables se presentan como categoricas, menos las variables de la <em>id</em> y <em>bins</em> que es la variable que contiene la clasificación binaria de si se dió o no la unión.
El resto de variables tienen la notación SMILE de cada uno de los bloques de construcción y la molecula completa.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="s2">&quot;block1&quot;</span><span class="p">,</span><span class="s2">&quot;block2&quot;</span><span class="p">,</span> <span class="s2">&quot;block3&quot;</span><span class="p">,</span> <span class="s2">&quot;molecule&quot;</span><span class="p">,</span><span class="s2">&quot;protein_name&quot;</span><span class="p">,</span><span class="s2">&quot;binds&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;id&#39;, &#39;block1&#39;, &#39;block2&#39;, &#39;block3&#39;, &#39;molecule&#39;, &#39;protein_name&#39;,
       &#39;binds&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p><strong>Bloque 1</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valores unicos&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">datos</span><span class="p">[</span><span class="s2">&quot;block1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cantidad de datos faltantes&#39;</span><span class="p">,</span><span class="n">datos</span><span class="p">[</span><span class="s2">&quot;block1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Valores unicos 271
Cantidad de datos faltantes 0
</pre></div>
</div>
</div>
</div>
<p><strong>Bloque 2</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valores unicos&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">datos</span><span class="p">[</span><span class="s2">&quot;block2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cantidad de datos faltantes&#39;</span><span class="p">,</span><span class="n">datos</span><span class="p">[</span><span class="s2">&quot;block2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Valores unicos 693
Cantidad de datos faltantes 0
</pre></div>
</div>
</div>
</div>
<p><strong>Bloque 3</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valores unicos&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">datos</span><span class="p">[</span><span class="s2">&quot;block3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cantidad de datos faltantes&#39;</span><span class="p">,</span><span class="n">datos</span><span class="p">[</span><span class="s2">&quot;block3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Valores unicos 872
Cantidad de datos faltantes 0
</pre></div>
</div>
</div>
</div>
<p>Con los análisis anteriores tenemos información importante, ninguno de los 3 bloques de construcción contiene datos faltantes y además vemos que el bloque uni tienen un total de 271 registros únicos, el bloque 2 tiene 693 registros únicos y el bloque 3 tiene 872 registros únicos. Esto podría traernos un poco de complicaciones mas adelante al momento de codificar nuestras variables para el modelo.</p>
<p><strong>Moleculas</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valores unicos&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">datos</span><span class="p">[</span><span class="s2">&quot;molecule&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cantidad de datos faltantes&#39;</span><span class="p">,</span><span class="n">datos</span><span class="p">[</span><span class="s2">&quot;molecule&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Valores unicos 98415610
Cantidad de datos faltantes 0
</pre></div>
</div>
</div>
</div>
<p>En el caso de la variable “Molecule”, en la cual se tienen registro de las estructuras moleculares, se tienen un total de 98’415.610 de registros únicos y 0 datos faltantes, se tiene una gran cantidad valores únicos en el conjunto de train.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="p">[</span><span class="s2">&quot;molecule&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>molecule
C#CCOc1ccc(CNc2nc(NCC3CCCN3c3cccnn3)nc(N[C@@H](CC#C)CC(=O)N[Dy])n2)cc1                       3
O=C1CSC(Nc2nc(Nc3cnc(Cl)cc3Cl)nc(Nc3ccc(C(F)(F)F)cc3C(=O)N[Dy])n2)=N1                        3
O=C1CSC(Nc2nc(Nc3ccc(C(F)(F)F)cc3C(=O)N[Dy])nc(Nc3n[nH]c4cc(Cl)ccc34)n2)=N1                  3
O=C1CSC(Nc2nc(Nc3ccc(C(F)(F)F)cc3C(=O)N[Dy])nc(Nc3n[nH]c4c(F)c(F)ccc34)n2)=N1                3
O=C1CSC(Nc2nc(Nc3ccc(C(F)(F)F)cc3C(=O)N[Dy])nc(Nc3n[nH]c4c(Cl)cc([N+](=O)[O-])cc34)n2)=N1    3
                                                                                            ..
Cc1cc(Nc2nc(NCc3nnn(C)c3C(F)F)nc(N[C@@H](Cc3ccc(F)cc3)C(=O)N[Dy])n2)ccn1                     3
Cc1cc(Nc2nc(Nc3ccc(=O)n(C)c3)nc(N[C@@H](Cc3ccc(F)cc3)C(=O)N[Dy])n2)ccn1                      3
Cc1cc(Nc2nc(NCc3cn(C)nc3Br)nc(N[C@@H](Cc3ccc(F)cc3)C(=O)N[Dy])n2)ccn1                        3
Cc1cc(Nc2nc(NCc3cn(C)c(=O)[nH]c3=O)nc(N[C@@H](Cc3ccc(F)cc3)C(=O)N[Dy])n2)ccn1                3
[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2noc3ccc(F)cc23)nc(Nc2noc3ccc(F)cc23)n1)C(=O)N[Dy]               3
Name: count, Length: 98415610, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Los resultados anteriores nos dejan ver que cada uno de los registros únicos se repiten 3 veces dentro del dataset, esto pues se tienen registro de cada una de las moleculas con cada una de las 3 proteinas para saber si con alguna de las 3 proteinas se obtuvo una reacción o no, es por esta razón que el dataset tienen como tamaño, el triple de los registros únicos de moleculas.</p>
<p><strong>Bins</strong></p>
<p>Podemos hacer un análisis para ver como se comporta la proporción de nuestra variable de clasificación binaria, la variable objetivo <em>bins</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="p">[</span><span class="s2">&quot;binds&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>binds
0    293656924
1      1589906
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1589906</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">datos</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5385006165857903
</pre></div>
</div>
</div>
</div>
<p>EL comprtamiento de nuestra variable respuesta es un poco preocupante puesto que existe un gran desequilibrio en el DataFrame, el 99% de los registros en la variable binaria responden a la categoría 0 y solo un 0.54% responden a la categoría 1, esto es un factor importante al momento de entrenar, validar y testear cualquier modelo.</p>
<p><em><strong>NOTA:</strong></em>
Es notable la gran dimensión de registros que se tienen en el dataset, para trabajar con esa cantidad de datos se necesitan unos recursos adecuados. En este análisis y por fines de reducir la complejidad de todos los códigos y la carga computacional que implica trabajar con millones de datos, se trabajará de manera independiente para cada proteina, es decir, se filtrará el data set por cada proteina y se tomará una muestra significativa en cada uno de ellos para crear los respetivos modelos de clasificación.</p>
</section>
<section id="filtro-por-proteina">
<h4><strong>Filtro por proteina</strong><a class="headerlink" href="#filtro-por-proteina" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="p">[</span><span class="s2">&quot;protein_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;BRD4&#39;, &#39;HSA&#39;, &#39;sEH&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">brd4</span><span class="o">=</span><span class="n">datos</span><span class="p">[</span><span class="n">datos</span><span class="p">[</span><span class="s2">&quot;protein_name&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;BRD4&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">brd4</span><span class="p">[</span><span class="s2">&quot;binds&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>binds
0    97958646
1      456964
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ceros</span><span class="o">=</span><span class="p">(</span><span class="mi">97958646</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">brd4</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">unos</span><span class="o">=</span><span class="p">(</span><span class="mi">456964</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">brd4</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Proporción de la categoría 0: &#39;</span><span class="p">,</span> <span class="n">ceros</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Proporción de la categoría 1: &#39;</span><span class="p">,</span> <span class="n">unos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Proporción de la categoría 0:  99.53567935005432
Proporción de la categoría 1:  0.4643206499456743
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hsa</span><span class="o">=</span><span class="n">datos</span><span class="p">[</span><span class="n">datos</span><span class="p">[</span><span class="s2">&quot;protein_name&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;HSA&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hsa</span><span class="p">[</span><span class="s2">&quot;binds&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>binds
0    98007200
1      408410
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ceros</span><span class="o">=</span><span class="p">(</span><span class="mi">98007200</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">hsa</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">unos</span><span class="o">=</span><span class="p">(</span><span class="mi">408410</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">hsa</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Proporción de la categoría 0: &#39;</span><span class="p">,</span> <span class="n">ceros</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Proporción de la categoría 1: &#39;</span><span class="p">,</span> <span class="n">unos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Proporción de la categoría 0:  99.58501501946692
Proporción de la categoría 1:  0.41498498053306787
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seh</span><span class="o">=</span><span class="n">datos</span><span class="p">[</span><span class="n">datos</span><span class="p">[</span><span class="s2">&quot;protein_name&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;sEH&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seh</span><span class="p">[</span><span class="s2">&quot;binds&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>binds
0    97691078
1      724532
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ceros</span><span class="o">=</span><span class="p">(</span><span class="mi">97691078</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">seh</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">unos</span><span class="o">=</span><span class="p">(</span><span class="mi">724532</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">seh</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Proporción de la categoría 0: &#39;</span><span class="p">,</span> <span class="n">ceros</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Proporción de la categoría 1: &#39;</span><span class="p">,</span> <span class="n">unos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Proporción de la categoría 0:  99.26380378072137
Proporción de la categoría 1:  0.7361962192786287
</pre></div>
</div>
</div>
</div>
<p>Al filtrar vemos que la diferencia entre las categorías se mantiene en los dataframe, nuestro objetivo de aquí en adelante es trabajar con estos 3 dataframe por separado, con el fin de lanzar modelos que puedan clasificar si se da o no la unión entre alguna de las 3 proteinas con distintas moleculas, es necesario tratar las variables de cada conjunto de datos para establecer cual será el conjunto X de entrenamiento en cada uno de los modelos.</p>
</section>
<section id="seh-hidrolasa-de-epoxido-soluble">
<h4><em><strong>SEH: Hidrolasa de Epóxido Soluble.</strong></em><a class="headerlink" href="#seh-hidrolasa-de-epoxido-soluble" title="Link to this heading">#</a></h4>
<section id="analisis-inicial">
<h5><strong>Análisis inicial.</strong><a class="headerlink" href="#analisis-inicial" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seh</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(98415610, 7)
</pre></div>
</div>
</div>
</div>
<p>Vemos que ahora nuetro dataframe cuenta con 98’415.610 registros, que es mucho menor que el anterior, pero aun así con nuestros recursos es muy dificil de procesar y modelar ese gran conjunto de datos es por eso que nos quedaremos solo con 100.000 registros elegidos al azar dentreo de los 98 millones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seh_final</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span> <span class="n">seh</span><span class="p">,</span> <span class="n">train_size</span> <span class="o">=</span> <span class="mi">100000</span><span class="p">,</span>  <span class="n">stratify</span> <span class="o">=</span> <span class="n">seh</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seh_final</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;final_seh_&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seh_final</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:/Users/fonta/OneDrive/Documentos/CDD/6. Sexto semestre/Machine learning/Primer parcial/Parcial_practico/final_seh_&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seh_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>block1</th>
      <th>block2</th>
      <th>block3</th>
      <th>molecule</th>
      <th>protein_name</th>
      <th>binds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>147239129</td>
      <td>O=C(Nc1c(Cl)cccc1C(=O)O)OCC1c2ccccc2-c2ccccc21</td>
      <td>CNC(=O)COCCN.Cl</td>
      <td>CN(CCN)C1CCOCC1</td>
      <td>CNC(=O)COCCNc1nc(NCCN(C)C2CCOCC2)nc(Nc2c(Cl)cc...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>257990426</td>
      <td>O=C(O)C[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)c1c...</td>
      <td>Nc1cc(N2CCNCC2)ccc1[N+](=O)[O-]</td>
      <td>Cl.NCCN1CCCS1(=O)=O</td>
      <td>O=C(C[C@@H](Nc1nc(NCCN2CCCS2(=O)=O)nc(Nc2cc(N3...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>180571076</td>
      <td>O=C(Nc1ccc(Br)c(C(=O)O)c1)OCC1c2ccccc2-c2ccccc21</td>
      <td>NCc1ccc2[nH]ccc2c1</td>
      <td>Cc1ccc(N)nn1</td>
      <td>Cc1ccc(Nc2nc(NCc3ccc4[nH]ccc4c3)nc(Nc3ccc(Br)c...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>186946937</td>
      <td>O=C(Nc1ccc(C(=O)O)c([N+](=O)[O-])c1)OCC1c2cccc...</td>
      <td>Cl.NCc1ccc(-c2c[nH]c(=O)[nH]c2=O)cc1</td>
      <td>Nc1ccsc1.O=C(O)C(=O)O</td>
      <td>O=C(N[Dy])c1ccc(Nc2nc(NCc3ccc(-c4c[nH]c(=O)[nH...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>207543668</td>
      <td>O=C(Nc1cccc(-c2cccc(C(=O)O)c2)c1O)OCC1c2ccccc2...</td>
      <td>Cl.NCC(=O)N1CCCO1</td>
      <td>Nc1c(O)ncnc1O</td>
      <td>O=C(N[Dy])c1cccc(-c2cccc(Nc3nc(NCC(=O)N4CCCO4)...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">seh_final</span><span class="p">[</span><span class="s1">&#39;molecule&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100000
</pre></div>
</div>
</div>
</div>
<p>Luego de hacer la selección aleatoria estratificada para reducir la cantidad de registros en el dataset de SEH, vemos que la cantidad de moléculas únicas en la selección es igual a la cantidad de registros; es por tanto que podemos decir que todas las moléculas son únicas. Así podemos decir que la estructura de la molécula en notación SMILE cumple la función de un estilo de identificación de la unión de los bloques. Esta variable será retirada al momento de crear el dataframe final para el entrenamiento de los modelos, ya que es posible que al incluirla pueda crear sobre ajuste.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seh_final</span><span class="p">[</span><span class="s2">&quot;binds&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>binds
0    99264
1      736
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ceros</span><span class="o">=</span><span class="p">(</span><span class="mi">99264</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">seh_final</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">unos</span><span class="o">=</span><span class="p">(</span><span class="mi">736</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">seh_final</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Proporción de la categoría 0: &#39;</span><span class="p">,</span> <span class="n">ceros</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Proporción de la categoría 1: &#39;</span><span class="p">,</span> <span class="n">unos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Proporción de la categoría 0:  99.264
Proporción de la categoría 1:  0.736
</pre></div>
</div>
</div>
</div>
<p>Luego de hacer el proceso de extraer 100.000 datos de la muestra orginal, vemos que las proporciones en la variable binearia, son similares al grupo de datos original, por tanto al cambiar el tamaño de los datos no hemos alterado la distribución de nuestra variable respuesta.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seh_final</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="nb">object</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>block1</th>
      <th>block2</th>
      <th>block3</th>
      <th>molecule</th>
      <th>protein_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>100000</td>
      <td>100000</td>
      <td>100000</td>
      <td>100000</td>
      <td>100000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>271</td>
      <td>693</td>
      <td>867</td>
      <td>100000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>top</th>
      <td>O=C(Nc1cc(C(=O)O)ccc1Br)OCC1c2ccccc2-c2ccccc21</td>
      <td>CC1(CCCCN)OCCO1</td>
      <td>CSc1nnc(CN)s1</td>
      <td>CNC(=O)COCCNc1nc(NCCN(C)C2CCOCC2)nc(Nc2c(Cl)cc...</td>
      <td>sEH</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>418</td>
      <td>261</td>
      <td>226</td>
      <td>1</td>
      <td>100000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si recordamos al incio de este análisis, veíamos la cantidad de datos únicos que se tenían en el set de datos orginales, en este data set con menos registros se mantienen la misma cantidad de registros únicos en las variaables “block1”, “Block2”y “Block3”.</p>
</section>
<section id="codificacion-de-las-variables-categoricas">
<h5><strong>Codificación de las variables categoricas.</strong><a class="headerlink" href="#codificacion-de-las-variables-categoricas" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">to_encode</span><span class="o">=</span><span class="n">seh_final</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">to_encode</span><span class="o">=</span><span class="n">to_encode</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Se hará la codificación de cada una de los valores únicos en las variables categóricas de interés, esto con el fin de poder ser incluídas en los modelos que se implementaran mas adelante, para cumplur esta acción se hará uso de la función OneHotEncoder().</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categorical_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">,</span> <span class="s1">&#39;block1&#39;</span><span class="p">,</span> <span class="s1">&#39;block2&#39;</span><span class="p">,</span> <span class="s1">&#39;block3&#39;</span><span class="p">]</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">one_hot_encoded</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">to_encode</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">])</span>
<span class="n">one_hot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">one_hot_encoded</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoder</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">))</span>
<span class="n">df_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">to_encode</span><span class="p">,</span> <span class="n">one_hot_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_encoded_seh</span> <span class="o">=</span> <span class="n">df_encoded</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encoded_seh</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>molecule</th>
      <th>binds</th>
      <th>protein_name_sEH</th>
      <th>block1_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>block3_Nc1ncnc(=O)[nH]1</th>
      <th>block3_Nc1ncnc(Cl)c1Cl</th>
      <th>block3_Nc1ncnc2[nH]cnc12</th>
      <th>block3_Nc1ncnc2[nH]ncc12</th>
      <th>block3_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>block3_Nc1ncncc1Br</th>
      <th>block3_Nc1nnc(S)s1</th>
      <th>block3_Nc1nncs1</th>
      <th>block3_Nc1nnn[nH]1</th>
      <th>block3_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>147239129</td>
      <td>CNC(=O)COCCNc1nc(NCCN(C)C2CCOCC2)nc(Nc2c(Cl)cc...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>257990426</td>
      <td>O=C(C[C@@H](Nc1nc(NCCN2CCCS2(=O)=O)nc(Nc2cc(N3...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>180571076</td>
      <td>Cc1ccc(Nc2nc(NCc3ccc4[nH]ccc4c3)nc(Nc3ccc(Br)c...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>186946937</td>
      <td>O=C(N[Dy])c1ccc(Nc2nc(NCc3ccc(-c4c[nH]c(=O)[nH...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>207543668</td>
      <td>O=C(N[Dy])c1cccc(-c2cccc(Nc3nc(NCC(=O)N4CCCO4)...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1836 columns</p>
</div></div></div>
</div>
<p>Como mencionamos anteriormente, la variable “molecule” y la variable “id” serán retiradas del dataframe, puesto que no aportan en nada al modelo al ser solo información de identificación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encoded_seh</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;molecule&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encoded_seh</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>binds</th>
      <th>protein_name_sEH</th>
      <th>block1_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C=CCC(CC=C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C=CCC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>block3_Nc1ncnc(=O)[nH]1</th>
      <th>block3_Nc1ncnc(Cl)c1Cl</th>
      <th>block3_Nc1ncnc2[nH]cnc12</th>
      <th>block3_Nc1ncnc2[nH]ncc12</th>
      <th>block3_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>block3_Nc1ncncc1Br</th>
      <th>block3_Nc1nnc(S)s1</th>
      <th>block3_Nc1nncs1</th>
      <th>block3_Nc1nnn[nH]1</th>
      <th>block3_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1834 columns</p>
</div></div></div>
</div>
<p>Con este dataset final procederemos a utilizar la función de <strong>chi2</strong> y <strong>SelectKBest</strong> del paquete de <strong>scikit-learn</strong>, con el fin de escoger 100 de las variables codificadas, de tal manera que las mismas expliquen de mejor manera la variable objetivo <strong>Bins</strong>.</p>
</section>
<section id="reduccion-de-multicolinialidad">
<h5><strong>Reducción de multicolinialidad.</strong><a class="headerlink" href="#reduccion-de-multicolinialidad" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train_seh</span> <span class="o">=</span> <span class="n">df_encoded_seh</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span>

<span class="c1"># Aplicar SelectKBest con chi2 para seleccionar las mejores características</span>
<span class="n">k_best1</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">score_func</span> <span class="o">=</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># Se quieren conservar k = 100 mejores características</span>
<span class="n">X_new1</span> <span class="o">=</span> <span class="n">k_best1</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_encoded_seh</span><span class="p">,</span> <span class="n">y_train_seh</span><span class="p">)</span>

<span class="n">selected_features</span> <span class="o">=</span> <span class="n">k_best1</span><span class="o">.</span><span class="n">get_support</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Obtener los índices de las características seleccionadas</span>
<span class="n">x_train_seh</span> <span class="o">=</span> <span class="n">df_encoded_seh</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">selected_features</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Con lo anterior tenemos como resultado nuestra matriz X de entrenamiento para la proteina seh y nuestro <em>y</em> de entrenamiento, se muestran a continuación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_train_seh</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>binds</th>
      <th>block1_O=C(NC(Cc1ccccc1)C(=O)O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_O=C(NCC1CCC(C(=O)O)CC1)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_O=C(NC[C@H]1CC[C@H](C(=O)O)CC1)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_O=C(N[C@@H](Cc1cccnc1)C(=O)O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_O=C(N[C@H](Cc1ccc(F)c(F)c1)C(=O)O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_O=C(Nc1ccc(C(=O)O)cc1)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_O=C(Nc1ccc(C(=O)O)cc1O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_O=C(Nc1ccc(C(=O)O)nc1)OCC1c2ccccc2-c2ccccc21</th>
      <th>...</th>
      <th>block3_Nc1c2c(cc3c1CCC3)CCC2</th>
      <th>block3_Nc1cc(C(F)(F)F)cc(C(F)(F)F)c1</th>
      <th>block3_Nc1cc(Cl)ccc1F</th>
      <th>block3_Nc1cc(F)c(F)cc1[N+](=O)[O-]</th>
      <th>block3_Nc1ccc2c(c1)CNCC2</th>
      <th>block3_Nc1cccc2ocnc12</th>
      <th>block3_Nc1cncc(F)c1</th>
      <th>block3_Nc1n[nH]c2ccc([N+](=O)[O-])cc12</th>
      <th>block3_Nc1nc(NCc2ccc(F)cc2)ccc1[N+](=O)[O-]</th>
      <th>block3_Nc1ncco1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train_seh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        0
1        0
2        0
3        0
4        0
        ..
99995    0
99996    0
99997    0
99998    0
99999    0
Name: binds, Length: 100000, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="hsa-soluble-epoxide-hydrolase-2">
<h4><em><strong>HSA: Soluble Epoxide Hydrolase 2.</strong></em><a class="headerlink" href="#hsa-soluble-epoxide-hydrolase-2" title="Link to this heading">#</a></h4>
<section id="id1">
<h5><strong>Análisis inicial.</strong><a class="headerlink" href="#id1" title="Link to this heading">#</a></h5>
<p>De igual manera como se hizo con la proteina <strong>SEH</strong>, tomaremos una muestra aleatoria estratificada del conjunto de datos filtrados de la base de datos original, se realiza esta acción puesto que es casi imposible con los recursos que se tienen en este momento trabajar con esa gran cantidad de datos, así que hacemos este ejercicio con el proposito de que algún día podamos lograr estos retos y mas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hsa_final</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span> <span class="n">hsa</span><span class="p">,</span> <span class="n">train_size</span> <span class="o">=</span> <span class="mi">100000</span><span class="p">,</span>  <span class="n">stratify</span> <span class="o">=</span> <span class="n">hsa</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hsa_final</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;final_hsa_&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hsa_final</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:/Users/fonta/OneDrive/Documentos/CDD/6. Sexto semestre/Machine learning/Primer parcial/Parcial_practico/final_hsa_&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hsa_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>block1</th>
      <th>block2</th>
      <th>block3</th>
      <th>molecule</th>
      <th>protein_name</th>
      <th>binds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>79451005</td>
      <td>O=C(NC1(C(=O)O)CCCCC1)OCC1c2ccccc2-c2ccccc21</td>
      <td>Nc1ccnc(Cl)c1</td>
      <td>N#Cc1cccc(N)n1</td>
      <td>N#Cc1cccc(Nc2nc(Nc3ccnc(Cl)c3)nc(NC3(C(=O)N[Dy...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>251510695</td>
      <td>O=C(O)C[C@@H](Cc1ccc([N+](=O)[O-])cc1)NC(=O)OC...</td>
      <td>Nc1ccc(O)cn1</td>
      <td>Cn1ncc2cc(N)ccc21</td>
      <td>Cn1ncc2cc(Nc3nc(Nc4ccc(O)cn4)nc(N[C@@H](CC(=O)...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>50733376</td>
      <td>Cc1cc(C(=O)O)ccc1NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>Cl.NCCOC1CCS(=O)(=O)C1</td>
      <td>Cn1nnc(N)n1</td>
      <td>Cc1cc(C(=O)N[Dy])ccc1Nc1nc(NCCOC2CCS(=O)(=O)C2...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>62661181</td>
      <td>Cn1cc(C[C@@H](NC(=O)OCC2c3ccccc3-c3ccccc32)C(=...</td>
      <td>Cl.NCC1CC(C(N)=O)=NO1</td>
      <td>Nc1ccc(F)c(C(F)(F)F)c1</td>
      <td>Cn1cc(C[C@@H](Nc2nc(NCC3CC(C(N)=O)=NO3)nc(Nc3c...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>266507149</td>
      <td>O=C(O)C[C@H](Cc1ccc(C(F)(F)F)cc1)NC(=O)OCC1c2c...</td>
      <td>Cl.Nc1ccc(O)cc1Cl</td>
      <td>Cc1ccnc(N)c1</td>
      <td>Cc1ccnc(Nc2nc(Nc3ccc(O)cc3Cl)nc(N[C@H](CC(=O)N...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hsa_final</span><span class="p">[</span><span class="s2">&quot;binds&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>binds
0    99585
1      415
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ceros</span><span class="o">=</span><span class="p">(</span><span class="mi">99585</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">hsa_final</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">unos</span><span class="o">=</span><span class="p">(</span><span class="mi">415</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">hsa_final</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Proporción de la categoría 0: &#39;</span><span class="p">,</span> <span class="n">ceros</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Proporción de la categoría 1: &#39;</span><span class="p">,</span> <span class="n">unos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Proporción de la categoría 0:  99.58500000000001
Proporción de la categoría 1:  0.415
</pre></div>
</div>
</div>
</div>
<p>Es importante notar que la proporción de las categorías de la variable respuesta se mantiene similar a las proporciones en los dataframes originales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hsa_final</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="nb">object</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>block1</th>
      <th>block2</th>
      <th>block3</th>
      <th>molecule</th>
      <th>protein_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>100000</td>
      <td>100000</td>
      <td>100000</td>
      <td>100000</td>
      <td>100000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>271</td>
      <td>693</td>
      <td>871</td>
      <td>100000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>top</th>
      <td>O=C(Nc1cc(Br)cc(C(=O)O)c1)OCC1c2ccccc2-c2ccccc21</td>
      <td>NCc1c(F)cccc1N1CCCC1</td>
      <td>Cc1nc(Cl)c(N)c(Cl)n1</td>
      <td>N#Cc1cccc(Nc2nc(Nc3ccnc(Cl)c3)nc(NC3(C(=O)N[Dy...</td>
      <td>HSA</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>435</td>
      <td>281</td>
      <td>224</td>
      <td>1</td>
      <td>100000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>No hay registros nuevos en las demas variables como lo muestra la describción, se tienen 271 valores únicos en Block1, 693 en Block2 y 871 en Block3.</p>
</section>
<section id="id2">
<h5><strong>Codificacíon de las variables categóricas.</strong><a class="headerlink" href="#id2" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">to_encode</span><span class="o">=</span><span class="n">hsa_final</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">to_encode</span><span class="o">=</span><span class="n">to_encode</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Se seguirán los mismos pasos de codificación usado en la proteina SEH, esta vez para la proteina HSA.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categorical_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">,</span> <span class="s1">&#39;block1&#39;</span><span class="p">,</span> <span class="s1">&#39;block2&#39;</span><span class="p">,</span> <span class="s1">&#39;block3&#39;</span><span class="p">]</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">one_hot_encoded</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">to_encode</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">])</span>
<span class="n">one_hot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">one_hot_encoded</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoder</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">))</span>
<span class="n">df_encoded_hsa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">to_encode</span><span class="p">,</span> <span class="n">one_hot_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_encoded_hsa</span> <span class="o">=</span> <span class="n">df_encoded_hsa</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encoded_hsa</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>molecule</th>
      <th>binds</th>
      <th>protein_name_HSA</th>
      <th>block1_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>block3_Nc1ncnc(=O)[nH]1</th>
      <th>block3_Nc1ncnc(Cl)c1Cl</th>
      <th>block3_Nc1ncnc2[nH]cnc12</th>
      <th>block3_Nc1ncnc2[nH]ncc12</th>
      <th>block3_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>block3_Nc1ncncc1Br</th>
      <th>block3_Nc1nnc(S)s1</th>
      <th>block3_Nc1nncs1</th>
      <th>block3_Nc1nnn[nH]1</th>
      <th>block3_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>79451005</td>
      <td>N#Cc1cccc(Nc2nc(Nc3ccnc(Cl)c3)nc(NC3(C(=O)N[Dy...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>251510695</td>
      <td>Cn1ncc2cc(Nc3nc(Nc4ccc(O)cn4)nc(N[C@@H](CC(=O)...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>50733376</td>
      <td>Cc1cc(C(=O)N[Dy])ccc1Nc1nc(NCCOC2CCS(=O)(=O)C2...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>62661181</td>
      <td>Cn1cc(C[C@@H](Nc2nc(NCC3CC(C(N)=O)=NO3)nc(Nc3c...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>266507149</td>
      <td>Cc1ccnc(Nc2nc(Nc3ccc(O)cc3Cl)nc(N[C@H](CC(=O)N...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1840 columns</p>
</div></div></div>
</div>
<p>De igual forma eliminamos las columnas “id” y “molecule”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encoded_hsa</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;molecule&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encoded_hsa</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>binds</th>
      <th>protein_name_HSA</th>
      <th>block1_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C=CCC(CC=C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C=CCC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>block3_Nc1ncnc(=O)[nH]1</th>
      <th>block3_Nc1ncnc(Cl)c1Cl</th>
      <th>block3_Nc1ncnc2[nH]cnc12</th>
      <th>block3_Nc1ncnc2[nH]ncc12</th>
      <th>block3_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>block3_Nc1ncncc1Br</th>
      <th>block3_Nc1nnc(S)s1</th>
      <th>block3_Nc1nncs1</th>
      <th>block3_Nc1nnn[nH]1</th>
      <th>block3_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1838 columns</p>
</div></div></div>
</div>
<p>Pasamos ahora a reducir la multicolinialidad entre nuestras variables.</p>
</section>
<section id="id3">
<h5><strong>Reducción de multicolinialidad.</strong><a class="headerlink" href="#id3" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train_hsa</span> <span class="o">=</span> <span class="n">df_encoded_hsa</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span>
<span class="n">k_best</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">score_func</span><span class="o">=</span><span class="n">chi2</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">X_new</span> <span class="o">=</span> <span class="n">k_best</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_encoded_hsa</span><span class="p">,</span> <span class="n">y_train_hsa</span><span class="p">)</span>

<span class="n">selected_features</span> <span class="o">=</span> <span class="n">k_best</span><span class="o">.</span><span class="n">get_support</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hsa_train</span> <span class="o">=</span> <span class="n">df_encoded_hsa</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">selected_features</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hsa_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>binds</th>
      <th>block1_CC(OC(C)(C)C)C(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_Cc1cc(Cl)cc(C(=O)O)c1NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_Cc1ccc(C(=O)O)cc1NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_O=C(NC(CC1CCCCC1)C(=O)O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_O=C(NC(Cc1ccccc1)C(=O)O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_O=C(N[C@@H](Cc1cccnc1)C(=O)O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_O=C(N[C@H](Cc1ccc(-c2ccccc2)cc1)C(=O)O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_O=C(Nc1cc(C(=O)O)cc(C(=O)O)c1)OCC1c2ccccc2-c2ccccc21</th>
      <th>...</th>
      <th>block3_Nc1cccc2ocnc12</th>
      <th>block3_Nc1cn[nH]c1</th>
      <th>block3_Nc1cncc(F)c1</th>
      <th>block3_Nc1n[nH]c2cc(F)ccc12</th>
      <th>block3_Nc1nc(Cl)c2[nH]cnc2n1</th>
      <th>block3_Nc1nc2c(s1)CN(C(=O)OCc1ccccc1)CC2</th>
      <th>block3_Nc1nc[nH]n1</th>
      <th>block3_Nc1ncnc(Cl)c1Cl</th>
      <th>block3_Nc1nncs1</th>
      <th>block3_Nc1nnn[nH]1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div></div></div>
</div>
<p>Siendo así el dataframe anterior nuestro conjunto de entrenamiento para los modelos de la proteina HSA, y se mantiene nuestra variable respuesta “bins”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train_hsa</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        0
1        0
2        0
3        0
4        0
        ..
99995    0
99996    0
99997    0
99998    0
99999    0
Name: binds, Length: 100000, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="brd4-bromodomain-containing-protein-4">
<h4><em><strong>BRD4: Bromodomain-containing protein 4</strong></em><a class="headerlink" href="#brd4-bromodomain-containing-protein-4" title="Link to this heading">#</a></h4>
<section id="id4">
<h5><strong>Análisis inicial.</strong><a class="headerlink" href="#id4" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">brd4_final</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span> <span class="n">brd4</span><span class="p">,</span> <span class="n">train_size</span> <span class="o">=</span> <span class="mi">100000</span><span class="p">,</span>  <span class="n">stratify</span> <span class="o">=</span> <span class="n">brd4</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">brd4_final</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;final_brd4_&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">brd4_final</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:/Users/fonta/OneDrive/Documentos/CDD/6. Sexto semestre/Machine learning/Primer parcial/Parcial_practico/final_brd4_&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">brd4_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>block1</th>
      <th>block2</th>
      <th>block3</th>
      <th>molecule</th>
      <th>protein_name</th>
      <th>binds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100174431</td>
      <td>O=C(N[C@@H](Cc1ccc(F)cc1F)C(=O)O)OCC1c2ccccc2-...</td>
      <td>Nc1nc(-c2cccnc2)cs1</td>
      <td>Cc1nnsc1CN</td>
      <td>Cc1nnsc1CNc1nc(Nc2nc(-c3cccnc3)cs2)nc(N[C@@H](...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>288634638</td>
      <td>O=C(O)[C@H]1CC2CCCCC2N1C(=O)OCC1c2ccccc2-c2ccc...</td>
      <td>Nc1ccncc1[N+](=O)[O-]</td>
      <td>Nc1nc2nc[nH]c2c(=O)[nH]1</td>
      <td>O=C(N[Dy])[C@H]1CC2CCCCC2N1c1nc(Nc2nc3nc[nH]c3...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>43808760</td>
      <td>C[C@@H](OCc1ccccc1)[C@H](NC(=O)OCC1c2ccccc2-c2...</td>
      <td>COc1c(F)cc(N)cc1F</td>
      <td>Nc1ccc(F)cc1CO</td>
      <td>COc1c(F)cc(Nc2nc(Nc3ccc(F)cc3CO)nc(N[C@H](C(=O...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>91037118</td>
      <td>O=C(N[C@@H](Cc1c(F)c(F)c(F)c(F)c1F)C(=O)O)OCC1...</td>
      <td>Cl.NCCOC1CCS(=O)(=O)C1</td>
      <td>Cl.Cl.NCCc1nnc2c(=O)[nH]ccn12</td>
      <td>O=C(N[Dy])[C@H](Cc1c(F)c(F)c(F)c(F)c1F)Nc1nc(N...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3471777</td>
      <td>C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>COC(=O)c1scnc1N</td>
      <td>NCC1CSCCN1Cc1ccccc1</td>
      <td>C#CC[C@H](CC(=O)N[Dy])Nc1nc(NCC2CSCCN2Cc2ccccc...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">brd4_final</span><span class="p">[</span><span class="s1">&#39;molecule&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">brd4_final</span><span class="p">[</span><span class="s2">&quot;binds&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>binds
0    99536
1      464
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ceros</span><span class="o">=</span><span class="p">(</span><span class="mi">99536</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">brd4_final</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">unos</span><span class="o">=</span><span class="p">(</span><span class="mi">464</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">brd4_final</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Proporción de la categoría 0: &#39;</span><span class="p">,</span> <span class="n">ceros</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Proporción de la categoría 1: &#39;</span><span class="p">,</span> <span class="n">unos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Proporción de la categoría 0:  99.536
Proporción de la categoría 1:  0.464
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">brd4_final</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="nb">object</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>block1</th>
      <th>block2</th>
      <th>block3</th>
      <th>molecule</th>
      <th>protein_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>100000</td>
      <td>100000</td>
      <td>100000</td>
      <td>100000</td>
      <td>100000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>271</td>
      <td>693</td>
      <td>871</td>
      <td>100000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>top</th>
      <td>O=C(N[C@@H](Cc1cc(F)c(F)c(F)c1)C(=O)O)OCC1c2cc...</td>
      <td>NCCC(=O)NC1CCCC1</td>
      <td>Cc1cc2cc(CN)ccc2[nH]1</td>
      <td>Cc1nnsc1CNc1nc(Nc2nc(-c3cccnc3)cs2)nc(N[C@@H](...</td>
      <td>BRD4</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>436</td>
      <td>272</td>
      <td>233</td>
      <td>1</td>
      <td>100000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Con estos análisis iniciales, se nota que este conjunto de datos de la proteina brd4 tiene el mismo comportamiento de los otros dos, lo cual es importante al momento de modelar.</p>
</section>
<section id="id5">
<h5><strong>Codificación de las variables categóricas.</strong><a class="headerlink" href="#id5" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">to_encode</span><span class="o">=</span><span class="n">brd4_final</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">to_encode</span><span class="o">=</span><span class="n">to_encode</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categorical_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">,</span> <span class="s1">&#39;block1&#39;</span><span class="p">,</span> <span class="s1">&#39;block2&#39;</span><span class="p">,</span> <span class="s1">&#39;block3&#39;</span><span class="p">]</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">one_hot_encoded</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">to_encode</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">])</span>
<span class="n">one_hot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">one_hot_encoded</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoder</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">))</span>
<span class="n">df_encoded_brd4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">to_encode</span><span class="p">,</span> <span class="n">one_hot_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_encoded_brd4</span> <span class="o">=</span> <span class="n">df_encoded_brd4</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encoded_brd4</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;molecule&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encoded_brd4</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>binds</th>
      <th>protein_name_BRD4</th>
      <th>block1_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C=CCC(CC=C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_C=CCC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>block3_Nc1ncnc(=O)[nH]1</th>
      <th>block3_Nc1ncnc(Cl)c1Cl</th>
      <th>block3_Nc1ncnc2[nH]cnc12</th>
      <th>block3_Nc1ncnc2[nH]ncc12</th>
      <th>block3_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>block3_Nc1ncncc1Br</th>
      <th>block3_Nc1nnc(S)s1</th>
      <th>block3_Nc1nncs1</th>
      <th>block3_Nc1nnn[nH]1</th>
      <th>block3_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1838 columns</p>
</div></div></div>
</div>
<p>Vemos que se ha completado la codificación del conjunto de datos de la proteina “BRD4”. Pasamos al ultimo paso que es reducir la dimensión del df, quedandonos con las 100 mejores caracteristicas que explican la variable respuesta “bins”.</p>
</section>
<section id="id6">
<h5><strong>Reducción de multicolinialidad</strong><a class="headerlink" href="#id6" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train_brd4</span> <span class="o">=</span> <span class="n">df_encoded_brd4</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span>
<span class="n">k_best</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">score_func</span><span class="o">=</span><span class="n">chi2</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">X_new</span> <span class="o">=</span> <span class="n">k_best</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_encoded_brd4</span><span class="p">,</span> <span class="n">y_train_brd4</span><span class="p">)</span>

<span class="n">selected_features</span> <span class="o">=</span> <span class="n">k_best</span><span class="o">.</span><span class="n">get_support</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">brd4_train</span> <span class="o">=</span> <span class="n">df_encoded_brd4</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">selected_features</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">brd4_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>binds</th>
      <th>block1_CC(C)(C)OC(=O)CCC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_CC(C)(C)OCC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_CC(C)CC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_CC(OC(C)(C)C)C(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>block1_N#Cc1ccc(C[C@@H](NC(=O)OCC2c3ccccc3-c3ccccc32)C(=O)O)cc1</th>
      <th>block1_O=C(NC(CC1CCCCC1)C(=O)O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_O=C(NC(CCc1ccccc1)C(=O)O)OCC1c2ccccc2-c2ccccc21</th>
      <th>block1_O=C(NC(Cc1ccccc1)C(=O)O)OCC1c2ccccc2-c2ccccc21</th>
      <th>...</th>
      <th>block3_Nc1cc(Cl)c(O)c(Cl)c1</th>
      <th>block3_Nc1cc(N2CCNCC2)ccc1[N+](=O)[O-]</th>
      <th>block3_Nc1ccc2[nH]ncc2c1</th>
      <th>block3_Nc1ccc2c(c1)CCC2=O</th>
      <th>block3_Nc1ccc2c(c1)CNC2=O</th>
      <th>block3_Nc1ccc2c(c1)COC2=O</th>
      <th>block3_Nc1cccnc1F</th>
      <th>block3_Nc1nc2ccccc2s1</th>
      <th>block3_Nc1nc2nc[nH]c2c(=O)[nH]1</th>
      <th>block3_Nc1nccs1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div></div></div>
</div>
<p>El conjunto anterior será nuestro set de entrenamiento para los modelos de la proteina <strong>BRD4</strong> y así mismo su conjunto Y en el entrenamiento será “bins”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train_brd4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        0
1        0
2        0
3        0
4        0
        ..
99995    0
99996    0
99997    0
99998    0
99999    0
Name: binds, Length: 100000, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modelacion-punto-3">
<h1><strong>Modelación: Punto 3</strong><a class="headerlink" href="#modelacion-punto-3" title="Link to this heading">#</a></h1>
<p>Como se explicó anteriormente, en esta sección se implementaran 3 modelos, uno por cada proteína objetivo con el fin de predecir si dada unos bloques de construcción de una molécula se da la unión con una de las 3 proteínas, se implementarán modelos de clasificación vistos en clase esta vez serán K-NN y regresión logística.</p>
<section id="seh">
<h2><em><strong>SEH</strong></em><a class="headerlink" href="#seh" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">x_train_seh</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">])</span>
<span class="n">y</span><span class="o">=</span><span class="n">y_train_seh</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_trainval</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_trainval</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span><span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="k-nn">
<h3><strong>K-NN</strong><a class="headerlink" href="#k-nn" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),(</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">())])</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">:</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span>
    <span class="s1">&#39;knn__weights&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">]</span>  
<span class="p">}]</span>

<span class="n">k_fold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="n">grid_search_k</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">k_fold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">grid_search_k</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainval</span><span class="p">,</span> <span class="n">y_trainval</span><span class="p">)</span>

<span class="n">best_parameters</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">best_score</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">best_score_</span>

<span class="n">model_pred_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">prob_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores parámetros: &quot;</span><span class="p">,</span> <span class="n">best_parameters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor score de entrenamiento: &quot;</span><span class="p">,</span> <span class="n">best_score</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score en el conjunto de test: &#39;</span><span class="p">,</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob_knn</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores parámetros:  {&#39;knn__n_neighbors&#39;: 14, &#39;knn__weights&#39;: &#39;distance&#39;}
Mejor score de entrenamiento:  0.8168980398319349
Score en el conjunto de test:  0.8146045109396463
</pre></div>
</div>
</div>
</div>
<p>Al hacer el respectivo GridSearch con Validación Cruzada nos arroja que el mejor parámetro para le modelo de K-NN es de K=14 vecinos más cercanos, con este parámetro se obtiene una métrica de ROC_AUC de 0.82 aproximadamente, teniendo en cuenta que esta métrica mide la capacidad que tiene el modelo de distinguir entre clases tiene todo el sentido que el modelo obtenga un buen AUC, puesto que el 99% de las clases de la variable respuesta es la 0, habría que revisar que pasa con las demás métricas. Vemos además que el score obtenido en el test, no es muy diferente, por tanto, no existe un sobre ajuste.</p>
</section>
<section id="regresion-logistica">
<h3><strong>Regresión logistica</strong><a class="headerlink" href="#regresion-logistica" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;logreg&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">))])</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s1">&#39;logreg__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span> 
<span class="p">}]</span>

<span class="n">k_fold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="n">grid_search_lr</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">k_fold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">grid_search_lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainval</span><span class="p">,</span> <span class="n">y_trainval</span><span class="p">)</span>

<span class="n">best_parameters</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">best_score</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">best_score_</span>

<span class="n">model_pred_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">prob_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores parámetros: &quot;</span><span class="p">,</span> <span class="n">best_parameters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor score de entrenamiento: &quot;</span><span class="p">,</span> <span class="n">best_score</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score en el conjunto de test: &#39;</span><span class="p">,</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob_lr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores parámetros:  {&#39;logreg__C&#39;: 0.01}
Mejor score de entrenamiento:  0.9459628169486717
Score en el conjunto de test:  0.9460246983012361
</pre></div>
</div>
</div>
</div>
<p>En el modelo de regresión logística para la proteína SEH con mayor score AUC es de 0.94 con el mejor parámetro c=0.01, vemos que el score del modelo de regresión logística es mayor que en modelo de K-NN, lo que quiere decir que el modelo que mejor diferencia las clases es la regresión logística. Este mejor modelo se obtiene con el parámetro c =0.01 lo que indica que el modelo está regularizado y su complejidad no es tan alta, de igual forma no existe sobre ajuste, no hay diferencia significativa entre los scores de entrenamiento y test.</p>
</section>
<section id="metricas">
<h3><strong>Métricas</strong><a class="headerlink" href="#metricas" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_pred_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">model_pred_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">prob_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">prob_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">tabla2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K-NN&#39;</span><span class="p">,</span> <span class="s1">&#39;Regresión Logística&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">),</span>
        <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">),</span>
        <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">),</span>
        <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob_knn</span><span class="p">),</span>  
        <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob_lr</span><span class="p">)</span>  
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">tabla</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla2</span><span class="p">)</span>
<span class="n">tabla</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN</td>
      <td>0.483871</td>
      <td>0.244565</td>
      <td>0.324910</td>
      <td>0.814605</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión Logística</td>
      <td>0.607843</td>
      <td>0.336957</td>
      <td>0.433566</td>
      <td>0.946025</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si no ponemos a pensar la “La métrica de negocio” para este estudio es reducir los falsos positivos,  ya que el interés  del estudio es predecir si la molécula y la proteína se unen o no, no es favorecedor tener falsos positivos. Con esto en mente debemos revisar la métrica <strong>Precisión</strong>, vemos que el mejor score en precisión se da en el modelo de regresión logística con un score de 0.61 aproximadamente, a diferencia del modelo K-NN que obtuvo un precisión de 0.48.</p>
</section>
<section id="curvas-roc-y-matrices-de-confucion">
<h3><strong>Curvas ROC y matrices de confución</strong><a class="headerlink" href="#curvas-roc-y-matrices-de-confucion" title="Link to this heading">#</a></h3>
<p><strong>Curvas ROC</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">probs_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span> 
<span class="n">probs_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">fpr_knn</span><span class="p">,</span> <span class="n">tpr_knn</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">probs_knn</span><span class="p">)</span>
<span class="n">fpr_lr</span><span class="p">,</span> <span class="n">tpr_lr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">probs_lr</span><span class="p">)</span>

<span class="n">roc_auc_knn</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr_knn</span><span class="p">,</span> <span class="n">tpr_knn</span><span class="p">)</span>
<span class="n">roc_auc_lr</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr_lr</span><span class="p">,</span> <span class="n">tpr_lr</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_knn</span><span class="p">,</span> <span class="n">tpr_knn</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;K-NN (AUC = </span><span class="si">{</span><span class="n">roc_auc_knn</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_lr</span><span class="p">,</span> <span class="n">tpr_lr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Regresión Logística (AUC = </span><span class="si">{</span><span class="n">roc_auc_lr</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos (FPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos (TPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curvas ROC&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ff8179fe72b769924046548df52e5ec587600297a2ef583495eccb4425bf8166.png" src="_images/ff8179fe72b769924046548df52e5ec587600297a2ef583495eccb4425bf8166.png" />
</div>
</div>
<p>Representación gráfica de lo dicho anteriormente, mostrando que la regresión logística está más cerca de la esquina superior izquierda, confirmando que el modelo de reg. logística tiene mejor distinción entre las clases.</p>
<p><strong>Matrices de confución</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix_knn</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">)</span>
<span class="n">conf_matrix_lr</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">ConfusionMatrixDisplay</span><span class="p">(</span><span class="n">conf_matrix_knn</span><span class="p">,</span> <span class="n">display_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Clase Negativa&#39;</span><span class="p">,</span> <span class="s1">&#39;Clase Positiva&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión - K-NN&#39;</span><span class="p">)</span>

<span class="n">ConfusionMatrixDisplay</span><span class="p">(</span><span class="n">conf_matrix_lr</span><span class="p">,</span> <span class="n">display_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Clase Negativa&#39;</span><span class="p">,</span> <span class="s1">&#39;Clase Positiva&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión - Regresión Logística&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/51d107944ebf6d004329c0850d4bb52b29c60cfd02309c7e11df4dec1ed208d9.png" src="_images/51d107944ebf6d004329c0850d4bb52b29c60cfd02309c7e11df4dec1ed208d9.png" />
</div>
</div>
<p>Las matrices de confusión nos muestran claramente en que afecta tener un conjunto de entrenamiento tan desbalanceado, en ambos modelos se entrenó muy bien como predecir la clase negativa, esto por consecuencia de tener la clase negativa como mayoritaria en el conjunto de entrenamiento, así, si vemos la cantidad de predicciones negativas que en realidad eran positivas son proporcionales en ambos modelos, al igual que los falsos positivos.</p>
</section>
</section>
<section id="hsa">
<h2><em><strong>HSA</strong></em><a class="headerlink" href="#hsa" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">hsa_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">])</span>
<span class="n">y</span><span class="o">=</span><span class="n">y_train_hsa</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_trainval</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_trainval</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span><span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id7">
<h3><strong>K-NN</strong><a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),(</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">())])</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">:[</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,],</span>
    <span class="s1">&#39;knn__weights&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">]</span> 
<span class="p">}]</span>

<span class="n">k_fold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">grid_search_k</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">k_fold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">grid_search_k</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainval</span><span class="p">,</span> <span class="n">y_trainval</span><span class="p">)</span>

<span class="n">best_parameters</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">best_score</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">best_score_</span>

<span class="n">model_pred_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">prob_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob_knn</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores parámetros: &quot;</span><span class="p">,</span> <span class="n">best_parameters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor score de entrenamiento: &quot;</span><span class="p">,</span> <span class="n">best_score</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score en el conjunto de test: &#39;</span><span class="p">,</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob_knn</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores parámetros:  {&#39;knn__n_neighbors&#39;: 30, &#39;knn__weights&#39;: &#39;distance&#39;}
Mejor score de entrenamiento:  0.7269284811010341
Score en el conjunto de test:  0.6988078097192011
</pre></div>
</div>
</div>
</div>
<p>Para este primer modelo de la proteína HSA, luego de implementar la respectiva validación cruzada y GridSearch se escogió como mejor modelo a aquel con parámetro k = 30, con un score en el entrenamiento de 0.72, pero vemos que si comparamos este score con el score obtenido en el conjunto de test que es de 0.70 aproximadamente, se llega a la conclusión de que hay un pequeño sobre ajuste, se debería evaluar si la diferencia es significativa o no.</p>
</section>
<section id="id8">
<h3><strong>Regresión logística.</strong><a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;logreg&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">))])</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s1">&#39;logreg__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span> 
<span class="p">}]</span>

<span class="n">k_fold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="n">grid_search_lr</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">k_fold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">grid_search_lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainval</span><span class="p">,</span> <span class="n">y_trainval</span><span class="p">)</span>

<span class="n">best_parameters</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">best_score</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">best_score_</span>

<span class="n">model_pred_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">prob_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores parámetros: &quot;</span><span class="p">,</span> <span class="n">best_parameters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor score de entrenamiento: &quot;</span><span class="p">,</span> <span class="n">best_score</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score en el conjunto de test: &#39;</span><span class="p">,</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob_lr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores parámetros:  {&#39;logreg__C&#39;: 0.1}
Mejor score de entrenamiento:  0.8833895826752356
Score en el conjunto de test:  0.9068030700019776
</pre></div>
</div>
</div>
</div>
<p>Por parte del modelo de regresión logística, se obtiene que el mejor modelo es aquel con un parámetro c= 0.1 que si vemos es el mismo parámetro del modelo logístico de la primera proteína, el score de este modelo es de 0.88, además en el conjunto de test se obtuvo un buen score, siendo este de 0.90</p>
</section>
<section id="id9">
<h3><strong>Métricas.</strong><a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_pred_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">model_pred_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">prob_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">prob_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">tabla2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K-NN&#39;</span><span class="p">,</span> <span class="s1">&#39;Regresión Logística&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">),</span>
        <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">),</span>
        <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">),</span>
        <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob_knn</span><span class="p">),</span>  
        <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob_lr</span><span class="p">)</span>  
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">tabla</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla2</span><span class="p">)</span>
<span class="n">tabla</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN</td>
      <td>0.214286</td>
      <td>0.028846</td>
      <td>0.050847</td>
      <td>0.698808</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión Logística</td>
      <td>0.375000</td>
      <td>0.057692</td>
      <td>0.100000</td>
      <td>0.906803</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Evaluando las diferentes métricas presentadas en la tabla anterior, podemos ver que estas son un poco bajas en comparación a las obtenidas en los modelos de la proteína SEH. Evaluando la métrica de negocio, que en este caso es precisión, vemos que en ambos modelos es muy baja, así que estos modelos no están captando de forma correcta la clase positiva de la variable respuesta, esto se verá más claro en la matriz de confusión.</p>
</section>
<section id="curvas-roc-y-matrices-de-confusion">
<h3><strong>Curvas ROC y matrices de confusión.</strong><a class="headerlink" href="#curvas-roc-y-matrices-de-confusion" title="Link to this heading">#</a></h3>
<p><strong>Curvas ROC</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">probs_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span> 
<span class="n">probs_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">fpr_knn</span><span class="p">,</span> <span class="n">tpr_knn</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">probs_knn</span><span class="p">)</span>
<span class="n">fpr_lr</span><span class="p">,</span> <span class="n">tpr_lr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">probs_lr</span><span class="p">)</span>

<span class="n">roc_auc_knn</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr_knn</span><span class="p">,</span> <span class="n">tpr_knn</span><span class="p">)</span>
<span class="n">roc_auc_lr</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr_lr</span><span class="p">,</span> <span class="n">tpr_lr</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_knn</span><span class="p">,</span> <span class="n">tpr_knn</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;K-NN (AUC = </span><span class="si">{</span><span class="n">roc_auc_knn</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_lr</span><span class="p">,</span> <span class="n">tpr_lr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Regresión Logística (AUC = </span><span class="si">{</span><span class="n">roc_auc_lr</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos (FPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos (TPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curvas ROC&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/14d40651d58ef7d597ba8d4ece8c4033604631071f2a0dba659bd397bebc1d2a.png" src="_images/14d40651d58ef7d597ba8d4ece8c4033604631071f2a0dba659bd397bebc1d2a.png" />
</div>
</div>
<p>En los gráficos de las curvas ROC de ambos modelos, vemos como efectivamente el modelo de regresión logística capta de mejor manera las diferentes clases, a diferencia del modelo K-NN que tiene un score más regular.</p>
<p><strong>Matrices de confisión.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix_knn</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">)</span>
<span class="n">conf_matrix_lr</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">ConfusionMatrixDisplay</span><span class="p">(</span><span class="n">conf_matrix_knn</span><span class="p">,</span> <span class="n">display_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Clase Negativa&#39;</span><span class="p">,</span> <span class="s1">&#39;Clase Positiva&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión - K-NN&#39;</span><span class="p">)</span>

<span class="n">ConfusionMatrixDisplay</span><span class="p">(</span><span class="n">conf_matrix_lr</span><span class="p">,</span> <span class="n">display_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Clase Negativa&#39;</span><span class="p">,</span> <span class="s1">&#39;Clase Positiva&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión - Regresión Logística&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8a24a969e458866960c7f657e96677ed94c122d8897272ca9129dd99461a9559.png" src="_images/8a24a969e458866960c7f657e96677ed94c122d8897272ca9129dd99461a9559.png" />
</div>
</div>
<p>Como lo mencionábamos anteriormente, en ambas matrices se puede observar como el modelo es capaz de predecir muy bien la clase negativa, pero la clase positiva es muy pequeña en comparación, esto por supuesto debido al gran desbalance que se encuentra en el conjunto de entrenamiento, además hablábamos un poco de como la métrica de Precisión es muy baja en ambos modelos y pues se ve claramente porque, ya que los modelos no logran captar bien la clase positiva.</p>
</section>
</section>
<section id="brd4">
<h2><strong>BRD4</strong><a class="headerlink" href="#brd4" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">brd4_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">])</span>
<span class="n">y</span><span class="o">=</span><span class="n">y_train_brd4</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_trainval</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_trainval</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span><span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id10">
<h3><strong>K-NN</strong><a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),(</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">())])</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">:[</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">],</span>
    <span class="s1">&#39;knn__weights&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">]</span>  
<span class="p">}]</span>

<span class="n">k_fold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">grid_search_k</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">k_fold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">grid_search_k</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainval</span><span class="p">,</span> <span class="n">y_trainval</span><span class="p">)</span>

<span class="n">best_parameters</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">best_score</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">best_score_</span>

<span class="n">model_pred_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">prob_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob_knn</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores parámetros: &quot;</span><span class="p">,</span> <span class="n">best_parameters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor score de entrenamiento: &quot;</span><span class="p">,</span> <span class="n">best_score</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score en el conjunto de test: &#39;</span><span class="p">,</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob_knn</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores parámetros:  {&#39;knn__n_neighbors&#39;: 60, &#39;knn__weights&#39;: &#39;distance&#39;}
Mejor score de entrenamiento:  0.8257008635190584
Score en el conjunto de test:  0.8658949941521765
</pre></div>
</div>
</div>
</div>
<p>Para la tercera proteína de interés, el BRD4, se obtuvo como mejor modelo, aquel con parámetro k=60, con un score en la métrica AUC de 0.82. Siendo este un score bastante adecuado, vemos que no se generó sobre ajuste, puesto que el score en el conjunto de test es de 0.86</p>
</section>
<section id="id11">
<h3><strong>Regresión logística.</strong><a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;logreg&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">))])</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s1">&#39;logreg__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>  
<span class="p">}]</span>

<span class="n">k_fold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="n">grid_search_lr</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">k_fold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">grid_search_lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainval</span><span class="p">,</span> <span class="n">y_trainval</span><span class="p">)</span>

<span class="n">best_parameters</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">best_score</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">best_score_</span>

<span class="n">model_pred_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">prob_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores parámetros: &quot;</span><span class="p">,</span> <span class="n">best_parameters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor score de entrenamientp: &quot;</span><span class="p">,</span> <span class="n">best_score</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score en el conjunto de test: &#39;</span><span class="p">,</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob_lr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores parámetros:  {&#39;logreg__C&#39;: 0.01}
Mejor score de entrenamientp:  0.9250193381948184
Score en el conjunto de test:  0.9633045607480779
</pre></div>
</div>
</div>
</div>
<p>Por el lado del modelo de regresión logística vemos que el mejor parámetro no varió entre los otros 2 modelos logísticos con una c=0.01, este caso, para la proteína BRD4 se obtuvo un score en el conjunto de entrenamiento de 0.92 y en el conjunto de test de 0.96, ambos scores bastante buenos y si generar sobre ajuste.</p>
</section>
<section id="id12">
<h3><strong>Métricas</strong><a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_pred_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">model_pred_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">prob_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">prob_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">tabla2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K-NN&#39;</span><span class="p">,</span> <span class="s1">&#39;Regresión Logística&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">),</span>
        <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">),</span>
        <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">),</span>
        <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob_knn</span><span class="p">),</span>  
        <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob_lr</span><span class="p">)</span>  
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">tabla</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla2</span><span class="p">)</span>
<span class="n">tabla</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN</td>
      <td>0.148148</td>
      <td>0.034483</td>
      <td>0.055944</td>
      <td>0.865895</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión Logística</td>
      <td>0.580645</td>
      <td>0.155172</td>
      <td>0.244898</td>
      <td>0.963305</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si comparamos nuestra métrica de negocio en estos últimos dos modelos, vemos que por parte del K-NN la precisión es bastante baja, lo que nos da a entender que su predicción en la clase positiva no es buena a comparación del modelo logístico que obtuvo un score más moderado de 0.58</p>
</section>
<section id="id13">
<h3><strong>Curvas ROC y matrices de confusión</strong><a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<p><strong>Curvas ROC</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">probs_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span> 
<span class="n">probs_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">fpr_knn</span><span class="p">,</span> <span class="n">tpr_knn</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">probs_knn</span><span class="p">)</span>
<span class="n">fpr_lr</span><span class="p">,</span> <span class="n">tpr_lr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">probs_lr</span><span class="p">)</span>

<span class="n">roc_auc_knn</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr_knn</span><span class="p">,</span> <span class="n">tpr_knn</span><span class="p">)</span>
<span class="n">roc_auc_lr</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr_lr</span><span class="p">,</span> <span class="n">tpr_lr</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_knn</span><span class="p">,</span> <span class="n">tpr_knn</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;K-NN (AUC = </span><span class="si">{</span><span class="n">roc_auc_knn</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_lr</span><span class="p">,</span> <span class="n">tpr_lr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Regresión Logística (AUC = </span><span class="si">{</span><span class="n">roc_auc_lr</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos (FPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos (TPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curvas ROC&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/caadb7c1de09a10d6a54fff414d31749de2f9d9a6875761313b6a695b895714f.png" src="_images/caadb7c1de09a10d6a54fff414d31749de2f9d9a6875761313b6a695b895714f.png" />
</div>
</div>
<p><strong>Matrices de confusión</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix_knn</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">)</span>
<span class="n">conf_matrix_lr</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">)</span>

<span class="c1"># Crear las visualizaciones de las matrices de confusión</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Matriz de confusión para K-NN</span>
<span class="n">ConfusionMatrixDisplay</span><span class="p">(</span><span class="n">conf_matrix_knn</span><span class="p">,</span> <span class="n">display_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Clase Negativa&#39;</span><span class="p">,</span> <span class="s1">&#39;Clase Positiva&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión - K-NN&#39;</span><span class="p">)</span>

<span class="c1"># Matriz de confusión para Regresión Logística</span>
<span class="n">ConfusionMatrixDisplay</span><span class="p">(</span><span class="n">conf_matrix_lr</span><span class="p">,</span> <span class="n">display_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Clase Negativa&#39;</span><span class="p">,</span> <span class="s1">&#39;Clase Positiva&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión - Regresión Logística&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ba306feeae03d9d975c72e5a59f4866b4dcd83ebb36101e9f0c201707230308d.png" src="_images/ba306feeae03d9d975c72e5a59f4866b4dcd83ebb36101e9f0c201707230308d.png" />
</div>
</div>
<p>Como se mencionó al momento de evaluar las métricas obtenidas, el modelo K-NN en su matriz de confusión muestra gráficamente por qué es que su Recoll es tan bajo, pues su proporción de predicciones correctas que si eran correctas es muy pequeña en comparación a las predicciones de la clase negativa, y como hemos venido diciendo, esto es por consecuencia de trabajar con un conjunto de datos de entrenamiento muy desbalanceado y si recordamos el EDA de este trabajo, el conjunto de datos de la proteína BRD4 era el más desbalanceado de los 3. Del lado derecho, en la matriz del modelo logístico, vemos que este sí logra captar un poco más la categoría positiva a diferencia del otro modelo.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="primerpunto_parte2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Punto 1 (parte 2)</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="segundopunto_parte2.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Punto 2 (parte 2)</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Punto 2 (parte 1) y Punto 3</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#neurips-2024-predict-new-medicines-with-belka"><strong>NeurIPS 2024 - Predict New Medicines with BELKA</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contexto"><strong>Contexto</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eda-punto-2"><strong>EDA: Punto 2</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conjunto-de-entrenamiento"><strong>Conjunto de entrenamiento</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#preliminares"><strong>Preliminares</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#filtro-por-proteina"><strong>Filtro por proteina</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#seh-hidrolasa-de-epoxido-soluble"><em><strong>SEH: Hidrolasa de Epóxido Soluble.</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-inicial"><strong>Análisis inicial.</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#codificacion-de-las-variables-categoricas"><strong>Codificación de las variables categoricas.</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#reduccion-de-multicolinialidad"><strong>Reducción de multicolinialidad.</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hsa-soluble-epoxide-hydrolase-2"><em><strong>HSA: Soluble Epoxide Hydrolase 2.</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>Análisis inicial.</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>Codificacíon de las variables categóricas.</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>Reducción de multicolinialidad.</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#brd4-bromodomain-containing-protein-4"><em><strong>BRD4: Bromodomain-containing protein 4</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>Análisis inicial.</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><strong>Codificación de las variables categóricas.</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><strong>Reducción de multicolinialidad</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelacion-punto-3"><strong>Modelación: Punto 3</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seh"><em><strong>SEH</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nn"><strong>K-NN</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logistica"><strong>Regresión logistica</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas"><strong>Métricas</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#curvas-roc-y-matrices-de-confucion"><strong>Curvas ROC y matrices de confución</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hsa"><em><strong>HSA</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><strong>K-NN</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><strong>Regresión logística.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><strong>Métricas.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#curvas-roc-y-matrices-de-confusion"><strong>Curvas ROC y matrices de confusión.</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brd4"><strong>BRD4</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><strong>K-NN</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><strong>Regresión logística.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><strong>Métricas</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13"><strong>Curvas ROC y matrices de confusión</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gwyneth Blanco y Nicoll Fontalvo
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>